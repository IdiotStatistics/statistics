
\chapter{仮説検定の3つの枠組み}
現在利用されている仮説検定の枠組みを紹介する。
それぞれの枠組みは前提が異なっており、それぞれの問題で良い推測を与える。
適切な枠組みを選ばなければ間違った解釈をしてしまう事になる。
我々の行なっている科学では、F型の枠組みを使う。
以降の章では、F型の問題について考える。



\begin{SMbox}{有意性検定・仮説検定}
    Fisherは、帰無仮説を設定し、帰無仮説とデータを比較検討する方法を構築した。これを、有意性検定という。これに対して、Neyman-Pearsonらは、帰無仮説に加えて、対立仮説を設定し、データを元に帰無仮説を棄却するかの判断を有意水準により行う意思決定の枠組みを構築した。これを、仮説検定と呼ぶことがある\cite{1573106361610039296}。
    現代の科学の多くは、FisherとNeyman-Pearsonの両方を組み合わせ、帰無仮説・対立仮説を設定し、帰無仮説とデータの乖離を$p$値によって調べ、棄却するかを検討する。ここでの$p$値は、Neyman-Pearsonの解釈から、20回に1回程度のことを有意と呼ぶことにしている。
    この流派をハイブリッド仮説検定法\cite{published_papers/18436201}と呼ぶことにする。
        %有意性検定を統計学\cite{upton2010統計学辞典,2009数理統計ハンドブック}や数学\cite{日本数学会2007岩波数学辞典}の辞書で調べたが、該当する言葉は見つからなかった。一方で、仮説検定は統計学\cite{upton2010統計学辞典,2009数理統計ハンドブック}などの辞書でも見つけることができた。
        %この言葉の使い方は、\cite{鳥類学における統計学_2018}に乗っていた。
\end{SMbox}



\section{F型}
F型では、既存の研究結果からモデルを構築し、そのモデルによりある集団の性質が予測できるかを調べる。
その後、計測結果を元に、その集団を予測できそうなモデルを構築する。
次の実験では、構築したモデルを利用し、予測が可能かを調べていく。
または、同じ集団についてさまざまな計測を行い、予測性能をあげるようにモデルを構築する。

\subsection{解決できる問題} 




\section{NP型}
NP型では、すでに前提になっていることから著しく外れたことが起きたことを検出するための方法である。
言い換えるなら、まず、何度も計測を行い、モデルが事象をよく予測できるようにモデルを構築する。
そして、母集団から無作為抽出し、標本を得る。
最後に、標本の統計検定量がモデルの予測を著しく外れているならば、
これまで計測していた現象が得られので、前提となる計測または母集団が変化したと疑う。

\subsection{解決できる問題}
NP型で扱う問題をいくつか挙げる。
\begin{quote}
    ある調味料の製造ラインでは, 砂糖の含有量 (g) は, 原料の不均一や製造ラインの狂いなどから変動するが, 標準偏差は常に一定で$\sigma=3$ の正規分布に従っているとしてよい. 各製品の砂糖の含有量が$\mu=60$になるように調整してラインを稼働させて, しばらくしてから, $25$個の製品を抜取検査したところ, 砂糖の含有量の平均値は$\bar{x}=61.63$であった. その時点で製造ラインは$\mu=60$を保持していると言えるだろうか.

    %\\ https://www.math.is.tohoku.ac.jp/~obata/student/subject/file/2019-EStat-All.pdf
\end{quote}
正規モデル$M(60,3^2)$によって予測ができるという前提条件を満たしている。この前提を元に、無作為抽出した$25$個がそのモデルにより予測できるのかを調べる。標本全体とモデルの累積分布などを比較する方法もあるが、ここでは、検定によって調べてみる。このモデルでは、
\begin{equation*}
    Z=\sqrt{n}\frac{\mu-\bar{x}}{\sigma} \sim N(0,1)
\end{equation*}
である。変数を入れれば、$Z=2.72$となる。$\varPhi(Z)<\varPhi(1/20=0.05)$であり、モデル内で、20回に1回よりも少ない頻度で観測されないようなことが現実で起きている。
または、$\varPhi(Z)<\varPhi(2\sigma=2)$であり、$2\sigma=2$(標準正規分布の中で)よりも珍しいことが起きているので、モデルでの予測ができないことが起きている。
偶発的に生じた可能性も捨てられないが、製造過程に不具合が生じているのではないかと推測される。



\subsection{解釈}

%NP型の問題では、前提が守られていることを確認できる状況においてのみ使える。
%言い換えれば、何度も何度も繰り返しモデルと現象を比較した結果、モデルが現象をよく予測できるということが確かめられているということである。
%頻度論で明らかになった数学を全て使うことができる。


\begin{SMbox}{第一の過誤・第二の過誤・統計モデルが正しい}
    Neyman-Pearson流の統計学においては、$\alpha,\beta$を次のように定義する。帰無仮説が正しいとき、誤ってそのモデルを棄却してしまう間違いを第一の過誤といい、この確率を$\alpha$とする。また、対立仮説が正しいのに、帰無モデルを採択する間違いを第二の過誤といい、この確率を$\beta$とする。

    %私は、ある統計モデルが正しいとは考えないので、「モデルが正しいとき、間違えてそのモデルを棄却する間違い」ということを考える流派に同意できなかった。
    %仮説は棄却されることはあるが、正しいことや積極的に採択されることは稀であるというのはFisherの流派が近い。
    %ただし、Fisherは、「$p$値を帰無仮説が正しいという条件のもとで、手元にあるデータ、およびさらに極端なデータが得られる確率」と定義した[\cite{1573106361610039296}]。
    %ここでの正しいという言葉の意図が重要である。
    %私は、「統計モデルの仮説が自然を記述するのにほどほど良いと考えられるとき、手元にあるデータの統計量以上の隔たりが統計モデル内で得られる確率」という意味であると捉え直し、科学的仮説検定を提案した。

    %Neyman-Pearson流派の統計学の教科書を科学の分野で見つけることができていない。
    %Fisher流派とNeyman-Pearson流派の両方を書いている教科書は存在しているが、「帰無モデルが正しい」とはどういうことかを答えたものを見つけることができていない。

    %Fisher流派とNeyman-Pearson流派の両方を同じように扱うことが問題視されることもある[\cite{published_papers/18436201}]。
\end{SMbox}


\section{ハイブリッド型}
\subsection{解決できる問題}


%\chapter{モデルを使った有意性検定}

\section{モデルの設定}
帰無仮説$\mu=\mu_0$をを含む統計モデル$M(\mu_0)$を帰無モデル($M_{H_0}$)、対立仮説$\mu\neq \mu_0$を含む統計モデル$M(\mu\neq\mu_0)$を対立モデル($M_{H_1}$)と呼ぶ。
一般に、統計モデルの否定したい母数$\mu_0$を帰無仮説と言い、その母数ではないという$\mu\neq\mu_0$を対立かせつと言います。つまり、次のように帰無仮説を含む統計モデル$M_0$を構築します。

具体的には、データがある特定の母数$\mu$をもつ統計モデルの信頼区間に含まれるか否かによって、統計モデルが棄却されるかを調べます。
\begin{itemize}
    \item i.i.d
    \item 数学関数
    \item 統計モデルの母数を$\mu$とし、$\mu=\mu_0$
\end{itemize}
一番最後の仮説が帰無仮説と言います。
対立仮説を含む統計モデル$M_1$は、$M_0$と同様の仮説(1),(2)から構成されますが、仮説3は統計モデル$M_0$と$M_1$で異なります。
\begin{itemize}
    \item i.i.d
    \item 数学関数
    \item 統計モデルの母数を$\mu$とし、$\mu\neq\mu_0$
\end{itemize}
一番最後の仮説が対立仮説です。$M_1$の最後の仮説は、$M_0$の最後の仮説の否定系になります。

二つの統計モデルを作って、$M_0$で計算される信頼区間に、データから得られる統計量が入らないなら、$M_0$は棄却されます。逆に、統計量が信頼区間に入るなら、何も起こりません。
このように、否定したい仮説を設定し、少なくとも帰無仮説を含む統計モデルはだめだったと判断します。

